syntax = "proto3";
package influxdata.iox.gossip.v1;
option go_package = "github.com/influxdata/iox/gossip/v1";

import "google/protobuf/timestamp.proto";

// A message exchanged via the IOx gossip mechanism to inform listeners of
// non-schema changes to cluster namespace state.
message NamespaceMessage {
  oneof event {
    // An existing namespace was updated.
    NamespaceUpdated namespace_updated = 2;
  }

  // Wall-clock time when this consistency probe was enqueued for broadcast
  // by the sending node.
  //
  // Clock-skew yada yada applies to any calculations done by nodes in receipt
  // of the message.
  google.protobuf.Timestamp sent_at = 15;
}

// An update to the non-schema properties of a namespace occurred.
message NamespaceUpdated {
  // Namespace ID
  int64 id = 1;

  // Name of the Namespace
  string name = 2;

  // Retention period in nanoseconds.
  //
  // NULL means "infinite retention".
  optional int64 retention_period_ns = 3;

  // The maximum number of tables which this namespace is allowed to contain.
  int32 max_tables = 4;

  // The maximum number of columns a table belonging to this namespace may have.
  int32 max_columns_per_table = 5;

  // A snapshot of the monotonically increasing counter which tracks the version
  // of this namespace's non-schema properties. 
  int64 router_version = 6;
}
